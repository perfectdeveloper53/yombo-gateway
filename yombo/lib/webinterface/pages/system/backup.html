{% extends "lib/webinterface/fragments/layout.tpl" %}

{% block content %}
<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">Gateway Backup</h1>
        <p>
            Although the configuration information is stored on Yombo servers, much of the information
            is encrypted using the gateway's GPG keys, which Yombo does not have access to or store. As such,
            it's important to backup the gateway shortly after installation.<br>
        </p>
        <p>
            There are two backups:
            <ul>
                <li><stong>Configuration</stong> - Saves GPG keys and yombo.ini.
                <li><stong>Database</stong> - Current database state. Includes historical info.</li>
            </ul>
        </p>
        <p>
            The <strong>configuration backup</strong> is the most important backup as well as the most sensitive.
            This backup includes GPG encryption keys and the Configuration file. Since all system passwords, as
            well as potential passwords for remote acces, you must keep this backup in a safe place. We highly
            encourage you to use the password backup feature which uses strong AES encryption.
        </p>
        <p>
            The <strong>database backup</strong> simply contains the database file. It's only important to
            periodically backup this file to preserve statistics information. The configurations within
            the database can be restored from the Yombo servers if needed.
        </p><br>
    </div>
    <!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">
    <div class="col-md-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3>Configuration backup</h3>
                <p>
                Create a configuration backup, used to quickly reinstall the gateway software without
                loosing important information.
                </p>
                <p>
                    <strong>Don't forget your password, there is no possible way to recover the
                    data without the password.</strong>
                </p>
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <h4>Create configuration backup</h4>
                <p>
                <form method="post" action="/system/backup/configuration">
                <label style="margin-top: 0px; margin-bottom: 0px">Password: </label><br>
                <div class="input-group">
                    <input type="password" tabindex="1" class="form-control" name="password1" id="password1" size="25" required>
                </div>

                <label style="margin-top: 0px; margin-bottom: 0px">Confirm password: </label><br>
                <div class="input-group">
                    <input type="password" tabindex="1" class="form-control" name="password2" id="password2" size="25" required>
                </div>
                <br>
                <button type="submit" class="btn btn-success">Download encrypted backup</button>
                </form>
                <p><br>
                    If desired, you can also download an un-encrypted version of the configuration data.
                </p>
                <a href="/system/backup/configuration" class="btn btn-md btn-danger">Download plaintext backup<br>
                    <strong>Not recommended!</strong></a>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3>Database backup</h3><br>
                Download a database snapshot.
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <p>
                    Current database size: {{_localize.bytes2human(db_size)}}
                </p>
                <p>
                    <a href="/system/backup/database" class="btn btn-md btn-primary">Download Database</a>
                </p>
                <p>
                    You can also manually backup the database:<br>
                    {{_atoms.get('yombo.path')}}/usr/etc/yombo.db
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
